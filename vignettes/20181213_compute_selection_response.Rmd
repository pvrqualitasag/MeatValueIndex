---
title: "Selection Response In Beef Cattle"
output: html_notebook
---


## Disclaimer
This notebook can be used for testing functions to compute asymptotic selection responses.

## Debugging
### Proportion of calves
```{r}
pvec_proportion_progeny_adult <- 0.5
pvec_number_progeny <- 20
proportion_calves <- 1 -  pvec_proportion_progeny_adult
proportion_calves
male_number_adults <- floor(pvec_proportion_progeny_adult[[1]]*pvec_number_progeny[[1]])
male_number_adults
male_number_calves <- pvec_number_progeny[[1]] - male_number_adults
male_number_calves
```

### Design matrix $Z_y$ 

```{r}
# Kronecker
kronecker_calves <- cbind(c(1,0,0),c(0,0,0),c(0,1,0),c(0,0,0),c(0,0,1),c(0,0,0))
kronecker_calves
kronecker_adults <- cbind(c(0,0,0),c(1,0,0),c(0,0,0),c(0,1,0),c(0,0,0),c(0,0,1))
kronecker_adults

# male
male_calves <- diag(1,male_number_calves)%x%kronecker_calves
male_calves <- cbind(male_calves,matrix(0, nrow=nrow(male_calves),ncol=male_number_adults*n))
male_adults <- diag(male_number_adults)%x%kronecker_adults
male_adults <- cbind(matrix(0, nrow=nrow(male_adults),ncol=male_number_calves*n),male_adults)
male_Z <- rbind(male_calves, male_adults)
male_Z<-cbind(matrix(0, nrow=male_offspring*(n/2),ncol=n),male_Z)

```

